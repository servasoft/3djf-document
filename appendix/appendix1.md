# 附录一

##location、position、空间规划###物理坐标 – position任意一个3D对象在三维直角坐标系中显示时，必定会有物理坐标信息，反应为投射到每个轴上的位置。在3D机房系统中，资产对象是一个3D对象，该对象有一个position属性（position有三个值，分别是X，Y，Z），代表在空间直角坐标系中的三个轴上的位置。###逻辑坐标 – location通过前面介绍的position属性，我们可以任意设定一个3D对象的位置信息，然而实际生活中，我们的被管对象往往是有规划的摆放。例如机房中可以摆4行10列机柜、机柜中可以摆下42个的1U的服务器。这些数据决定了空间坐标中的显示位置，然后又没有跟空间坐标的直接关联。在3D机房系统中这种逻辑坐标称为location。系统会将逻辑坐标location计算出一个物理坐标position，用来摆放显示。那3D机房系统是怎么计算出的position的呢？
我们还需要引入一个概念：空间规划，例如前面提到的机房里面可以摆放4行10列，机柜可以摆放42个1U服务器。在资产模型中的size和childrenSize属性表示空间规划概念，后面会详细介绍。例如上面的举例，机房的childrenSize值是{“x” : 10, “z” : 4}，42U的机柜的size值是{“x” : 1,“z” : 1}，它的childrenSize值是{y:42}。到此已经很清楚计算过程了，把机房外观尺寸（1000，1000，1000）的x方向分成10等份，每一份是100，z方向分成4等份，每一份是250来计算机柜的位置，例如机柜的location是（2，0，1），计算出的position值为（100*2，0， 1*250）。那么设备的位置就是把机柜的y（高度）除了42，来计算单个设备的位置，例如机柜高速是H，一个1U的设备摆放在4U的位置，那么postion属性的y值等于H / 42 * 4。房间四周可能需要空留部分通道，不能用来摆放机柜、设备的x和z方向因为跟机柜对奇没有设置值，具体会在后面的内容介绍。
location属性介绍：x，y，z分别表示3个方位的布局，支持数字和对齐方式（［‘pos_neg’，‘center_neg’，‘neg_neg’ ，‘center’ ，‘pos_pos’ ，‘center_pos’，‘neg_pos’］）两种方式。对齐方式说明：‘_’前面对应的是自身，’_’后面对应的是父亲
如以x轴为例，即x:’pos_neg’…共七中情况

1. pos_neg:表示的是自己在x轴最大值处于父亲在x轴最小值处对齐；2. center_neg:表示的的是自己在x轴的中心点和父亲在x轴最小处值对齐；3. neg_neg:表示的是自己在X轴最小处和父亲在x轴最小处对齐；4. center:自己在x轴的中心点和父亲在x轴的中心点对齐；5. pos_pos:自己在x轴的最大值和父亲在x轴的最大值处对齐；6. center_pos:自己在x轴的中心点和父亲在x轴的最大值处对齐；7. neg_pos:自己在x轴的最小处和父亲在x轴的最大值对齐；例如机柜的location位置是（2， 0， 1），x = 2表示第二列，z = 1 表示在第一排，y值"neg_pos" 表示一种对齐方式，表示机柜的最下面和机房模型的最上面对齐。如下图：前面的矩形代表自己，后面的代表父亲，并且向右代表正方向，那么下面这种情况就是：“pos_neg”

```       __________ _____|          ||     |          ||     |          ||_____|__________|
```###空间规则在上面的介绍中引入了空间规划的概念，空间规划的本质是父对象和子对象之间的物理位置重叠，本着更符合人机工程思维，将物理位置抽象出来，将物理单位转换成逻辑单位，简单理解为将空间或平面按最小单位划分成很多小格子，一个子对象最少要占用一个格子或整数倍。例如前面的房间尺寸是（1000，0，1000）柜子的尺寸是（100， 100， 250），那么房间抽象出来的容积为（10，0，4），即可以摆放4行10列柜子，容积是4＊10＝40，如果有四个柜子的location是（2，0，1）、（3，0，1）、（4，0，1）、（5，0，1）， 那么房间利用率就是4 ／ 40（房间容积）＊100% ＝ 10%，剩余空间率为90%。包括在计算整个机房内机柜的空间占用情况时，将会更加直观给出结果。
空间规划相关的两个属性：size和childrenSize。
size：表示自身所占的位置，属性包括x、y、z，分别表示三个方向的尺寸。例如2U的服务器，需要占用2个1U的高度。那么值为：｛y：2｝例如

```
var size = {“x”: 1,”z” : 1};
```childrenSize：属性包括：x、y、z、xPadding、yPadding、zPadding。其中x、y和z表示其中x、y和z表示可以容纳子对象的数量，xPadding、yPadding和zPadding的值是一个二维数组，默认是［0，0］，表示三个方向相需要扣除的间隙。例如42U的机柜，有42个U的高度，如果装1U的设备可以容纳42个，如果装2U的设备则只能容纳21个。那么值为：｛y：42｝

```var childrenSize={
	y:42,
	yPadding:[5.545,5.545],
	zPadding:[-0.5,-0.5],
	xPadding:[5.545,5.545]
};
```空间规划在计算空间利用率等指标时，会根据size和childrenSize来计算剩余空间和已经使用的空间。